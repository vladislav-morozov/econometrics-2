<!DOCTYPE html>
<html lang="en"><head>
<link href="../../themes/favicon.ico" rel="icon">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-0de45b8b5f35a93596f1d788d60c4c11.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/quarto-contrib/reveal-header-1.0.0/add_header.js" defer="true"></script>
<link href="../../site_libs/quarto-contrib/reveal-header-1.0.0/add_header.css" rel="stylesheet">
<script src="../../site_libs/quarto-contrib/sc-sb-title-1.0.0/sc_sb_title.js" defer="true"></script>
<link href="../../site_libs/quarto-contrib/grid-no-htext-1.0.0/grid_no_htext.css" rel="stylesheet"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.42">

  <meta name="author" content="Vladislav Morozov">
  <title>Advanced Econometrics – Inference I: Linear Hypotheses</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {  background-color: #f8f8f8; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ef2929; } /* Alert */
    code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #204a87; } /* Attribute */
    code span.bn { color: #0000cf; } /* BaseN */
    code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4e9a06; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #8f5902; font-style: italic; } /* Comment */
    code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
    code span.dt { color: #204a87; } /* DataType */
    code span.dv { color: #0000cf; } /* DecVal */
    code span.er { color: #a40000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #0000cf; } /* Float */
    code span.fu { color: #204a87; font-weight: bold; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
    code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
    code span.ot { color: #8f5902; } /* Other */
    code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
    code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
    code span.ss { color: #4e9a06; } /* SpecialString */
    code span.st { color: #4e9a06; } /* String */
    code span.va { color: #000000; } /* Variable */
    code span.vs { color: #4e9a06; } /* VerbatimString */
    code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-cb5537517b990794adf0c72e32550bcc.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
   

  <!-- This is what works with Quarto and MathJax 3+ -->

  <script>

    MathJax = {

      tex: {

        tags: 'ams',  // should be 'ams', 'none', or 'all'

        macros: {

          vect: ["\\mathbf{#1}", 1],

          mat: ["\\mathbf{#1}", 1], 

  

          bA: "\\boldsymbol{A}",

          bB: "\\boldsymbol{B}",

          bC: "\\boldsymbol{C}",

          bD: "\\boldsymbol{D}",

          bE: "\\boldsymbol{E}",

          bF: "\\boldsymbol{F}",

          bG: "\\boldsymbol{G}",

          bH: "\\boldsymbol{H}",

          bI: "\\boldsymbol{I}",

          bJ: "\\boldsymbol{J}",

          bK: "\\boldsymbol{K}",

          bL: "\\boldsymbol{L}",

          bM: "\\boldsymbol{M}",

          bN: "\\boldsymbol{N}",

          bP: "\\boldsymbol{P}",

          bQ: "\\boldsymbol{Q}",

          bR: "\\boldsymbol{R}",

          bS: "\\boldsymbol{S}",

          bT: "\\boldsymbol{T}",

          bU: "\\boldsymbol{U}",

          bV: "\\boldsymbol{V}",

          bW: "\\boldsymbol{W}",

          bX: "\\boldsymbol{X}",

          bY: "\\boldsymbol{Y}",

          bZ: "\\boldsymbol{Z}",

          ba: "\\boldsymbol{a}",

          bb: "\\boldsymbol{b}",

          bc: "\\boldsymbol{c}",

          bd: "\\boldsymbol{d}",

          be: "\\boldsymbol{e}",

          bg: "\\boldsymbol{g}",

          bh: "\\boldsymbol{h}",

          bi: "\\boldsymbol{\\imath}",

          bm: "\\boldsymbol{m}",

          bp: "\\boldsymbol{p}",

          bq: "\\boldsymbol{q}",

          br: "\\boldsymbol{r}",

          bs: "\\boldsymbol{s}",

          bt: "\\boldsymbol{t}",

          bu: "\\boldsymbol{u}",

          bv: "\\boldsymbol{v}",

          bw: "\\boldsymbol{w}",

          bx: "\\boldsymbol{x}",

          by: "\\boldsymbol{y}",

  

          Acal: "\\mathcal{A}",

          Bcal: "\\mathcal{B}",

          Ccal: "\\mathcal{C}",

          Dcal: "\\mathcal{D}",

          Ecal: "\\mathcal{E}",

          Fcal: "\\mathcal{F}",

          Gcal: "\\mathcal{G}",

          Hcal: "\\mathcal{H}",

          Ical: "\\mathcal{I}",

          Jcal: "\\mathcal{J}",

          Kcal: "\\mathcal{K}",

          Lcal: "\\mathcal{L}",

          Mcal: "\\mathcal{M}",

          Ncal: "\\mathcal{N}",

          Ocal: "\\mathcal{O}",

          Pcal: "\\mathcal{P}",

          Qcal: "\\mathcal{Q}",

          Rcal: "\\mathcal{R}",

          Scal: "\\mathcal{S}",

          Tcal: "\\mathcal{T}",

          Ucal: "\\mathcal{U}",

          Vcal: "\\mathcal{V}",

          Wcal: "\\mathcal{W}",

          Xcal: "\\mathcal{X}",

          Ycal: "\\mathcal{Y}",

          Zcal: "\\mathcal{Z}",

  

          A: "\\mathbb{A}",

          B: "\\mathbb{B}",

          C: "\\mathbb{C}",

          D: "\\mathbb{D}",

          E: "\\mathbb{E}",

          F: "\\mathbb{F}",

          G: "\\mathbb{G}",

          H: "\\mathbb{H}",

          I: "\\mathbb{I}",

          J: "\\mathbb{J}",

          K: "\\mathbb{K}",

          L: "\\mathbb{L}",

          M: "\\mathbb{M}",

          N: "\\mathbb{N}",

          O: "\\mathbb{O}",

          P: "\\mathbb{P}",

          Q: "\\mathbb{Q}",

          R: "\\mathbb{R}",

          S: "\\mathbb{S}",

          T: "\\mathbb{T}",

          U: "\\mathbb{U}",

          V: "\\mathbb{V}",

          W: "\\mathbb{W}",

          X: "\\mathbb{X}",

          Y: "\\mathbb{Y}",

          Z: "\\mathbb{Z}",

  

          bAlpha: "\\boldsymbol{\\Alpha}",

          bBeta: "\\boldsymbol{\\beta}",

          bDelta: "\\boldsymbol{\\delta}",

          bEta: "\\boldsymbol{\\eta}",

          bGamma: "\\boldsymbol{\\Gamma}",

          bLambda: "\\boldsymbol{\\Lambda}",

          bOmega: "\\boldsymbol{\\Omega}",

          bPhi: "\\boldsymbol{\\Phi}",

          bPi: "\\boldsymbol{\\Pi}",

          bPsi: "\\boldsymbol{\\Psi}",

          bSigma: "\\boldsymbol{\\Sigma}",

          bTau: "\\boldsymbol{\\tau}",

          bXi: "\\boldsymbol{\\Xi}",

          bbeta: "\\boldsymbol{\\beta}",

          bdelta: "\\boldsymbol{\\delta}",

          blambda: "\\boldsymbol{\\lambda}",

          bmu: "\\boldsymbol{\\mu}",

          bphi: "\\boldsymbol{\\phi}",

          bpi: "\\boldsymbol{\\pi}",

          bpsi: "\\boldsymbol{\\psi}",

          brho: "\\boldsymbol{\\rho}",

          bsigma: "\\boldsymbol{\\sigma}",

          btau: "\\boldsymbol{\\tau}",

          bxi: "\\boldsymbol{\\xi}",

          bEta: "\\boldsymbol{\\eta}",

          bPhi: "\\boldsymbol{\\Phi}",

          bPi: "\\boldsymbol{\\Pi}",

          bPsi: "\\boldsymbol{\\Psi}",

          bXi: "\\boldsymbol{\\Xi}",

          blambda: "\\boldsymbol{\\lambda}",

          bmu: "\\boldsymbol{\\mu}",

          bphi: "\\boldsymbol{\\phi}",

          bpi: "\\boldsymbol{\\pi}",

          bpsi: "\\boldsymbol{\\psi}",

          brho: "\\boldsymbol{\\rho}",

          bsigma: "\\boldsymbol{\\sigma}",

          btheta: "\\boldsymbol{\\theta}",

                     

          curl: ["\\left\\lbrace#1\\right\\rbrace", 1],

          floor: ["\\left\\lfloor#1\\right\\rfloor", 1],

          ceil: ["\\left\\lceil#1\\right\\rceil", 1],

          abs: ["\\left\\lvert#1\\right\\rvert", 1],

          norm: ["\\left\\lVert#1\\right\\rVert", 1],

  

          avar: "\\mathrm{avar}",

          var: "\\mathrm{var}",

          cov: "\\mathrm{cov}",

  

          argmin: "\\operatorname*{arg\\,min}",

          argmax: "\\operatorname*{arg\\,max}",

          argsup: "\\operatorname*{arg\\,sup}",

          arginf: "\\operatorname*{arg\\,inf}",

        }

      }

    };

  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
  <meta name="description" content="Explore testing linear hypotheses and constructing confidence intervals: t-tests, Wald tests, and asymptotic confidence intervals (lecture notes slides).">
<meta property="og:title" content="Inference I: Linear Hypotheses – Advanced Econometrics">
<meta property="og:description" content="Explore testing linear hypotheses and constructing confidence intervals: t-tests, Wald tests, and asymptotic confidence intervals (lecture notes slides).">
<meta property="og:site_name" content="Advanced Econometrics">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#045D5D" data-footer="" class="quarto-title-block center">
  <h1 class="title">Inference I: Linear Hypotheses</h1>
  <p class="subtitle">Testing Linear Hypotheses. Confidence Intervals</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Vladislav Morozov 
</div>
</div>
</div>

</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Contents</h2>
<ul>
<li class="fragment"><a href="#/introduction" id="/toc-introduction">Introduction</a></li>
<li class="fragment"><a href="#/background-and-definitions-for-testing" id="/toc-background-and-definitions-for-testing">Background and Definitions for Testing</a></li>
<li class="fragment"><a href="#/one-linear-hypothesis" id="/toc-one-linear-hypothesis">One Linear Hypothesis</a></li>
<li class="fragment"><a href="#/general-linear-hypotheses" id="/toc-general-linear-hypotheses">General Linear Hypotheses</a></li>
<li class="fragment"><a href="#/confidence-intervals-and-sets" id="/toc-confidence-intervals-and-sets">Confidence Intervals and Sets</a></li>
<li class="fragment"><a href="#/recap-and-conclusions" id="/toc-recap-and-conclusions">Recap and Conclusions</a></li>
</ul>
</nav>
</section>
<section>
<section id="introduction" class="title-slide slide level2 center" data-background="#00100F">
<h2>Introduction</h2>

</section>
<section id="lecture-info" class="title-slide slide level3 center" data-background="#43464B" data-visibility="uncounted">
<h3>Lecture Info</h3>

</section>
<section id="learning-outcomes" class="slide level4">
<h4>Learning Outcomes</h4>
<p>This lecture is about testing linear hypotheses and constructing asymptotic confidence intervals based on the OLS estimator</p>
<p><br></p>
<p>By the end, you should be able to</p>
<ul>
<li class="fragment">Define test power, size, and test consistency</li>
<li class="fragment">Construct and prove properties of <span class="math inline">\(t\)</span>- and Wald tests</li>
<li class="fragment">Construct valid asymptotic confidence intervals for a single coefficients</li>
</ul>
</section>
<section id="references" class="slide level4">
<h4>References</h4>
<div>
<ul>
<li>5-2, 8-2 and E4+E4a in <span class="citation" data-cites="Wooldridge2020IntroductoryEconometricsModern">Wooldridge (<a href="#/references-1" role="doc-biblioref" onclick="">2020</a>)</span> (careful with the specialized formulas in 8-2, they may be a bit confusing compared to the general case in the lecture and those in E4)</li>
<li>Or 7.11-7.13, 7.16, 9.1-9.9 in <span class="citation" data-cites="Hansen2022Econometrics">Hansen (<a href="#/references-1" role="doc-biblioref" onclick="">2022</a>)</span></li>
<li>(<em>Curious background reading</em>): <span class="citation" data-cites="Wooldridge2023WhatStandardError">Wooldridge (<a href="#/references-1" role="doc-biblioref" onclick="">2023</a>)</span> on the meaning of “standard error”</li>
</ul>
</div>
</section>

<section id="reminder-on-the-empirical-example" class="title-slide slide level3 center" data-background="#43464B" data-visibility="uncounted">
<h3>Reminder on the Empirical Example</h3>

</section>
<section id="reminder-empirical-model" class="slide level4">
<h4>Reminder: Empirical Model</h4>
<p>Studying link between wages and (education, experience) <span id="eq-vector-inference-emp-model"><span class="math display">\[
\begin{aligned}[]
&amp; [\ln(\text{wage}_i)]^{\text{(education, experience)}} \\
&amp;  =   \beta_1 + \beta_2 \times \text{education} \\
&amp; \quad  + \beta_3 \times  \text{experience} + \beta_4 \times  \dfrac{\text{experience}^2}{100} + U_i
\end{aligned}
\tag{1}\]</span></span></p>
<div class="fragment">
<p>Data: married white women from March 2009 CPS</p>
<div id="f4826114" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Expand for full data preparation code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a></a><span class="im">import</span> statsmodels.api <span class="im">as</span> sm</span>
<span id="cb1-4"><a></a></span>
<span id="cb1-5"><a></a><span class="im">from</span> statsmodels.regression.linear_model <span class="im">import</span> OLS</span>
<span id="cb1-6"><a></a></span>
<span id="cb1-7"><a></a><span class="co"># Read in the data</span></span>
<span id="cb1-8"><a></a>data_path <span class="op">=</span> (<span class="st">"https://github.com/pegeorge/Econ521_Datasets/"</span></span>
<span id="cb1-9"><a></a>             <span class="st">"raw/refs/heads/main/cps09mar.csv"</span>)</span>
<span id="cb1-10"><a></a>cps_data <span class="op">=</span> pd.read_csv(data_path)</span>
<span id="cb1-11"><a></a></span>
<span id="cb1-12"><a></a><span class="co"># Generate variables</span></span>
<span id="cb1-13"><a></a>cps_data[<span class="st">"experience"</span>] <span class="op">=</span> cps_data[<span class="st">"age"</span>] <span class="op">-</span> cps_data[<span class="st">"education"</span>] <span class="op">-</span> <span class="dv">6</span></span>
<span id="cb1-14"><a></a>cps_data[<span class="st">"experience_sq_div"</span>] <span class="op">=</span> cps_data[<span class="st">"experience"</span>]<span class="op">**</span><span class="dv">2</span><span class="op">/</span><span class="dv">100</span></span>
<span id="cb1-15"><a></a>cps_data[<span class="st">"wage"</span>] <span class="op">=</span> cps_data[<span class="st">"earnings"</span>]<span class="op">/</span>(cps_data[<span class="st">"week"</span>]<span class="op">*</span>cps_data[<span class="st">"hours"</span>] )</span>
<span id="cb1-16"><a></a>cps_data[<span class="st">"log_wage"</span>] <span class="op">=</span> np.log(cps_data[<span class="st">'wage'</span>])</span>
<span id="cb1-17"><a></a></span>
<span id="cb1-18"><a></a><span class="co"># Retain only married women white with present spouses</span></span>
<span id="cb1-19"><a></a>select_data <span class="op">=</span> cps_data.loc[</span>
<span id="cb1-20"><a></a>    (cps_data[<span class="st">"marital"</span>] <span class="op">&lt;=</span> <span class="dv">2</span>) <span class="op">&amp;</span> (cps_data[<span class="st">"race"</span>] <span class="op">==</span> <span class="dv">1</span>) <span class="op">&amp;</span> (cps_data[<span class="st">"female"</span>] <span class="op">==</span> <span class="dv">1</span>), :</span>
<span id="cb1-21"><a></a>]</span>
<span id="cb1-22"><a></a></span>
<span id="cb1-23"><a></a><span class="co"># Construct X and y for regression </span></span>
<span id="cb1-24"><a></a>exog <span class="op">=</span> select_data.loc[:, [<span class="st">'education'</span>, <span class="st">'experience'</span>, <span class="st">'experience_sq_div'</span>]]</span>
<span id="cb1-25"><a></a>exog <span class="op">=</span> sm.add_constant(exog)</span>
<span id="cb1-26"><a></a>endog <span class="op">=</span> select_data.loc[:, <span class="st">"log_wage"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="footer">

</div>
</div>
</section>
<section id="reminder-estimation-results" class="slide level4">
<h4>Reminder: Estimation Results</h4>
<div class="sourceCode" id="cb2" data-code-line-numbers="0-1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a></a>results <span class="op">=</span> OLS(endog, exog).fit(cov_type<span class="op">=</span><span class="st">'HC0'</span>) <span class="co"># Robust covariance matrix estimator</span></span>
<span id="cb2-2"><a></a><span class="bu">print</span>(results.summary())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="952e3671" class="cell" data-execution_count="2">
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:               log_wage   R-squared:                       0.226
Model:                            OLS   Adj. R-squared:                  0.226
Method:                 Least Squares   F-statistic:                     862.5
Date:                Mon, 19 May 2025   Prob (F-statistic):               0.00
Time:                        17:37:44   Log-Likelihood:                -8152.9
No. Observations:               10402   AIC:                         1.631e+04
Df Residuals:                   10398   BIC:                         1.634e+04
Df Model:                           3                                         
Covariance Type:                  HC0                                         
=====================================================================================
                        coef    std err          z      P&gt;|z|      [0.025      0.975]
-------------------------------------------------------------------------------------
const                 0.9799      0.040     24.675      0.000       0.902       1.058
education             0.1114      0.002     50.185      0.000       0.107       0.116
experience            0.0229      0.002     12.257      0.000       0.019       0.027
experience_sq_div    -0.0347      0.004     -8.965      0.000      -0.042      -0.027
==============================================================================
Omnibus:                     4380.404   Durbin-Watson:                   1.833
Prob(Omnibus):                  0.000   Jarque-Bera (JB):           134722.859
Skew:                          -1.401   Prob(JB):                         0.00
Kurtosis:                      20.406   Cond. No.                         219.
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity robust (HC0)</code></pre>
</div>
</div>
</section>
<section id="reminder-parameters-of-interest-and-estimators" class="slide level4">
<h4>Reminder: Parameters of Interest and Estimators</h4>
<p><br></p>
<p>Our parameters of interest:</p>
<ol type="1">
<li class="fragment"><span class="math inline">\(100\beta_2\)</span>. Estimate: <span class="math inline">\(11.14\)</span></li>
<li class="fragment"><span class="math inline">\(100\beta_3 + 20 \beta_4\)</span>. Estimate: <span class="math inline">\(1.59\)</span></li>
<li class="fragment"><span class="math inline">\(-50\beta_3/\beta_4\)</span>. Estimate: <span class="math inline">\(36.67\)</span></li>
</ol>
<div class="fragment">
<p><br></p>
<div class="rounded-box">
<p>What is the interpretation of those parameters?</p>
</div>
</div>
</section>
<section id="reminder-empirical-questions" class="slide level4">
<h4>Reminder: Empirical Questions</h4>
<p><br></p>
<ol type="1">
<li class="fragment">Does education matter at all? (up to our statistical confidence)</li>
<li class="fragment">Does experience matter at all? (up to our statistical confidence)</li>
<li class="fragment">Is the best amount of experience to have equal to 15 years? (up to our statistical confidence)</li>
<li class="fragment">How certain are we of our estimates of target parameters?</li>
</ol>
</section>
</section>
<section>
<section id="background-and-definitions-for-testing" class="title-slide slide level2 center" data-background="#00100F">
<h2>Background and Definitions for Testing</h2>

</section>
<section id="basic-setup-hypotheses" class="slide level4">
<h4>Basic Setup: Hypotheses</h4>
<p>Suppose that we have a model with some parameters <span class="math inline">\(\theta\)</span> (of whatever nature)</p>
<p>Two competing <em>hypotheses</em> (statements about parameters <span class="math inline">\(\theta\)</span>) <span class="math display">\[
H_0: \theta\in \Theta_0 \text{  vs.  } H_1: \theta \in \Theta_1
\]</span> for some non-intersecting <span class="math inline">\(\Theta_0\)</span> and <span class="math inline">\(\Theta_1\)</span></p>
<div class="fragment">
<p>Example</p>
<ul>
<li class="fragment"><span class="math inline">\(H_0: \beta_2=0\)</span> (education does not affect wages)</li>
<li class="fragment"><span class="math inline">\(H_1: \beta_2\neq 0\)</span> (education affects wages)</li>
</ul>
</div>
</section>
<section id="definition-of-a-test" class="slide level4">
<h4>Definition of a Test</h4>
<p>A test is a <em>decision rule</em>: you see the sample and then you decide in favor of <span class="math inline">\(H_0\)</span> or <span class="math inline">\(H_1\)</span></p>
<div class="fragment">
<p><br></p>
<p>Formally:</p>
<div class="rounded-box">
<div id="def-vector-inference-test" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1</strong></span> A test <span class="math inline">\(T\)</span> is a function of the sample <span class="math inline">\((X_1, \dots, X_N)\)</span> to the space <span class="math inline">\(\curl{\text{Reject } H_0,  \text{Do not reject }H_0}\)</span></p>
</div>
</div>
</div>
</section>
<section id="power" class="slide level4">
<h4>Power</h4>
<p><br></p>
<div class="rounded-box">
<div id="def-vector-inference-power" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2</strong></span> The power function <span class="math inline">\(\text{Power}_T(\theta)\)</span> of the test <span class="math inline">\(T\)</span> is the probability that <span class="math inline">\(T\)</span> rejects if <span class="math inline">\(\theta\)</span> is the true parameter value: <span class="math display">\[
\text{Power}_T(\theta) = P(T(X_1, \dots, X_N)=\text{Reject }H_0|\theta)
\]</span></p>
</div>
</div>
</section>
<section id="test-size" class="slide level4">
<h4>Test Size</h4>
Maximal power under the null has a special name
<div class="rounded-box">
<div id="def-vector-inference-size" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 3</strong></span> The <span class="highlight"> size </span> <span class="math inline">\(\alpha\)</span> of the test <span class="math inline">\(T\)</span> is <span class="math display">\[
\alpha = \max_{\theta\in\Theta_0} \text{Power}_T(\theta)
\]</span></p>
</div>
</div>
<p>In other words, the probability of falsely rejecting the null (type I error)</p>
</section>
<section id="what-defines-a-good-test" class="slide level4">
<h4>What Defines a Good Test?</h4>
<p>The best possible test has perfect detection:</p>
<ul>
<li class="fragment">Never rejects under <span class="math inline">\(H_0\)</span></li>
<li class="fragment">Always reject under <span class="math inline">\(H_1\)</span></li>
</ul>
<div class="fragment">
<p><br></p>
<p>Usually impossible in practice. Instead we ask</p>
<ul>
<li class="fragment">Not too much false rejection under <span class="math inline">\(H_0\)</span> (e.g.&nbsp;<span class="math inline">\(\leq 5\%\)</span> of the time)</li>
<li class="fragment">As much rejection as possible under <span class="math inline">\(H_1\)</span></li>
</ul>
</div>
</section>
<section id="test-consistency" class="slide level4">
<h4>Test Consistency</h4>
<ul>
<li class="fragment">In finite samples, usually cannot compute <span class="math inline">\(\text{Power}_T(\theta)\)</span></li>
<li class="fragment">Instead ask that you detect <span class="math inline">\(H_1\)</span> <span class="highlight"> asymptotically </span></li>
</ul>
<div class="fragment">
<div class="rounded-box">
<div id="def-vector-inference-consistency" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 4</strong></span> <span class="math inline">\(T\)</span> is <em>consistent</em> if for any <span class="math inline">\(\theta\in \Theta_1\)</span> <span class="math display">\[ \small
\lim_{N\to\infty} P(T(X_1, \dots, X_N)=\text{Reject }H_0|\theta) = 1
\]</span></p>
</div>
</div>
<div class="callout callout-important no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p>As with estimators, we say “test” when we mean a sequence of tests, one for each sample size.</p>
</div>
</div>
</div>
<div class="footer">

</div>
</div>
</section>
<section id="asymptotic-size" class="slide level4">
<h4>Asymptotic Size</h4>
<ul>
<li class="fragment">In finite samples, usually cannot control size exactly</li>
<li class="fragment">But can require it asymptotically</li>
</ul>
<div class="rounded-box">
<div id="def-vector-inference-asy-significane" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5</strong></span> The asymptotic size <span class="math inline">\(\alpha\)</span> of the test <span class="math inline">\(T\)</span> is <span class="math display">\[
\alpha = \lim_{N\to\infty} \max_{\theta\in\Theta_0}  P(T(X_1, \dots, X_N)=\text{Reject }H_0|\theta)
\]</span></p>
</div>
</div>
</section></section>
<section>
<section id="one-linear-hypothesis" class="title-slide slide level2 center" data-background="#00100F">
<h2>One Linear Hypothesis</h2>

</section>
<section id="example-and-t-statistic" class="title-slide slide level3 center" data-background="#43464B" data-visibility="uncounted">
<h3>Example and <span class="math inline">\(t\)</span>-Statistic</h3>

</section>
<section id="single-example-hypothesis" class="slide level4">
<h4>Single Example Hypothesis</h4>
<p>Let’s start with our first empirical question:</p>
<div class="rounded-box">
<p>Does education affect wages?</p>
</div>
<div class="fragment">
<p><br></p>
<p>In the framework of <a href="#/eq-vector-inference-emp-model" class="quarto-xref">Equation&nbsp;1</a> can translate to <span class="math display">\[
H_0: \beta_2 = 0, \quad H_1: \beta_2\neq 0
\]</span> What are the <span class="math inline">\(\Theta_0\)</span> and <span class="math inline">\(\Theta_1\)</span> here if <span class="math inline">\(\theta=\bbeta\)</span>?</p>
<!-- Here $\Theta_1 = \curl{0}$ and $\Theta_2 = \R - \curl{0}$ -->
</div>
</section>
<section id="how-testing-works-in-general" class="slide level4">
<h4>How Testing Works in General</h4>
<p><em>How do we construct a test/decision rule?</em></p>
<p><br></p>
<div class="fragment">
<p>The basic approach to testing is surprisingly simple</p>
<ol type="1">
<li class="fragment">Pick a “statistic” (=some known function of the data) that behaves “differently” under <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span></li>
<li class="fragment">Is the observed value of the statistic compatible with <span class="math inline">\(H_0\)</span>?
<ul>
<li class="fragment">No <span class="math inline">\(\Rightarrow\)</span> reject <span class="math inline">\(H_0\)</span> in favor or <span class="math inline">\(H_1\)</span></li>
<li class="fragment">Yes <span class="math inline">\(\Rightarrow\)</span> do not reject <span class="math inline">\(H_0\)</span></li>
</ul></li>
</ol>
</div>
</section>
<section id="picking-a-statistic" class="slide level4">
<h4>Picking a Statistic</h4>
<ul>
<li class="fragment">In principle, can pick any statistic. Some are more “standard”</li>
<li class="fragment">For testing hypotheses about coefficients, there are three main classes:
<ul>
<li class="fragment">Wald statistics: need only <em>unrestricted</em> estimates</li>
<li class="fragment">Lagrange multiplier (LM): need <em>restricted</em> estimates</li>
<li class="fragment">Likelihood ratio (LR): need both</li>
</ul></li>
</ul>
<div class="fragment">
<div class="callout callout-note no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p>Wald tests easiest to work with in linear models, but others have their uses in different contexts</p>
</div>
</div>
</div>
</div>
</section>
<section id="convergence-of-hatbeta_2" class="slide level4">
<h4>Convergence of <span class="math inline">\(\hat{\beta}_2\)</span></h4>
<p>Recall asymptotic distribution result for OLS estimator <span class="math display">\[\small
\sqrt{N}\left( \hat{\bbeta}- \bbeta \right) \xrightarrow{d} N(0, \avar(\hat{\bbeta}))
\]</span></p>
<div class="fragment">
<p>It implies (why?) that <span class="math display">\[ \small
\dfrac{\hat{\beta}_2 - \beta_2}{\sqrt{ \avar(\hat{\beta}_2)/N }  } \xrightarrow{d} N\left(0, 1\right)
\]</span> where <span class="math inline">\(\avar(\hat{\beta}_2)\)</span> is the (2, 2) element of <span class="math inline">\(\avar(\hat{\bbeta})\)</span></p>
</div>
</section>
<section id="t-statistic" class="slide level4">
<h4><span class="math inline">\(t\)</span>-statistic</h4>
<ul>
<li class="fragment">Let <span class="math inline">\(\widehat{\avar}(\hat{\bbeta})\)</span> be a consistent estimator of <span class="math inline">\(\avar(\hat{\bbeta})\)</span></li>
<li class="fragment">Let <span class="math inline">\(H_0: \beta_2 = 0\)</span> be true</li>
</ul>
<div class="fragment">
<p>By Slutsky’s theorem (why?) it holds that <span class="math display">\[ \small
t = \dfrac{\hat{\beta}_2}{\sqrt{ \widehat{\avar}(\hat{\beta}_2)/N }  } \xrightarrow{d} N\left(0, 1\right)
\]</span> <span class="math inline">\(\sqrt{ \widehat{\avar}(\hat{\beta}_2)/N }\)</span> — <span class="highlight">standard error</span> of <span class="math inline">\(\hat{\beta}_2\)</span></p>
<div class="footer">

</div>
</div>
</section>
<section id="sec-ols-inference-t-test" class="slide level4">
<h4>Decision Rule: Test</h4>
<p>We call the following the <span class="highlight">asymptotic size <span class="math inline">\(\alpha\)</span> <span class="math inline">\(t\)</span>-test</span>:</p>
<p><br></p>
<div class="rounded-box">
<p>Let <span class="math inline">\(z_{1-\alpha/2} = \Phi^{-1}(1-\alpha/2)\)</span>. Then</p>
<ul>
<li class="fragment">Reject <span class="math inline">\(H_0\)</span> is <span class="math inline">\(\abs{t}&gt;z_{1-\alpha/2}\)</span></li>
<li class="fragment">Do not reject <span class="math inline">\(H_0\)</span> is <span class="math inline">\(\abs{t}\leq z_{1-\alpha/2}\)</span></li>
</ul>
</div>
</section>

<section id="illustration" class="title-slide slide level3 center" data-background="#43464B" data-visibility="uncounted">
<h3>Illustration</h3>

</section>
<section id="illustration-extracting-standard-errors" class="slide level4 scrollable">
<h4>Illustration: Extracting Standard Errors</h4>
<p>Can get <span class="math inline">\(\widehat{\avar}(\hat{\bbeta})\)</span> from the <code>results</code> object:</p>
<div id="16fb383b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a></a>(results.nobs)<span class="op">*</span>results.cov_params()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>

<table class="dataframe caption-top" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header" style="text-align: right;">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">const</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">experience</th>
<th data-quarto-table-cell-role="th">experience_sq_div</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">const</td>
<td>16.406611</td>
<td>-0.790339</td>
<td>-0.411821</td>
<td>0.668941</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">education</td>
<td>-0.790339</td>
<td>0.051218</td>
<td>0.003703</td>
<td>-0.001191</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">experience</td>
<td>-0.411821</td>
<td>0.003703</td>
<td>0.036156</td>
<td>-0.072529</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">experience_sq_div</td>
<td>0.668941</td>
<td>-0.001191</td>
<td>-0.072529</td>
<td>0.156187</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><code>cov_params()</code> extracts <span class="math inline">\(\widehat{\avar}(\hat{\bbeta})/N\)</span></p>
<div class="footer">

</div>
</section>
<section id="illustration-doing-the-test-by-hand" class="slide level4">
<h4>Illustration: Doing the Test by Hand</h4>
<p>Compute <span class="math inline">\(t\)</span>-statistic as</p>
<div id="63542c85" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a></a>t <span class="op">=</span> (results.params.iloc[<span class="dv">1</span>])<span class="op">/</span>np.sqrt(results.cov_params().iloc[<span class="dv">1</span>, <span class="dv">1</span>])</span>
<span id="cb5-2"><a></a><span class="bu">print</span>(t)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>50.18487673168109</code></pre>
</div>
</div>
<ul>
<li class="fragment">Can compare <code>t</code> statistic to suitable quantile of the normal</li>
<li class="fragment">Set <span class="math inline">\(\alpha=0.05\)</span> if want to reject at most 5% under <span class="math inline">\(H_0\)</span> in the limit</li>
</ul>
<div class="fragment">
<div id="d0bb328c" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a></a><span class="im">from</span> scipy.stats <span class="im">import</span> norm</span>
<span id="cb7-2"><a></a>np.<span class="bu">abs</span>(t) <span class="op">&gt;</span> norm.ppf(<span class="dv">1</span><span class="op">-</span><span class="fl">0.05</span><span class="op">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>np.True_</code></pre>
</div>
</div>
<p>Reject <span class="math inline">\(H_0\)</span> in favor <span class="math inline">\(H_1: \beta_2\neq 0\)</span> at 5% asymptotic level</p>
<div class="footer">

</div>
</div>
</section>
<section id="illustration-using-t_test" class="slide level4">
<h4>Illustration: Using <code>t_test()</code></h4>
<p>Can also use</p>
<div id="b0f0974b" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a></a>results.t_test(np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>]), use_t<span class="op">=</span><span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>&lt;class 'statsmodels.stats.contrast.ContrastResults'&gt;
                             Test for Constraints                             
==============================================================================
                 coef    std err          z      P&gt;|z|      [0.025      0.975]
------------------------------------------------------------------------------
c0             0.1114      0.002     50.185      0.000       0.107       0.116
==============================================================================</code></pre>
</div>
</div>
<div class="fragment">
<ul>
<li class="fragment">Reports <span class="highlight">asymptotic</span> <span class="math inline">\(p\)</span>-values</li>
<li class="fragment">Decision by comparing with the <span class="math inline">\(p\)</span>-value</li>
<li class="fragment">Can reject with high confidence (very small <span class="math inline">\(p\)</span>-value)</li>
</ul>
</div>
</section>
<section id="illustration-t-test-from-the-regression-results" class="slide level4">
<h4>Illustration: <span class="math inline">\(t\)</span> Test From the Regression Results</h4>
<p>Regression results also print out results for <span class="math inline">\(t\)</span>-tests of hypotheses <span class="math inline">\(H_0:\beta_k=0\)</span></p>
<div id="1876229e" class="cell" data-execution_count="7">
<div class="cell-output cell-output-stdout">
<pre><code>                            OLS Regression Results                            
==============================================================================
Dep. Variable:               log_wage   R-squared:                       0.226
Model:                            OLS   Adj. R-squared:                  0.226
Method:                 Least Squares   F-statistic:                     862.5
Date:                Mon, 19 May 2025   Prob (F-statistic):               0.00
Time:                        17:37:44   Log-Likelihood:                -8152.9
No. Observations:               10402   AIC:                         1.631e+04
Df Residuals:                   10398   BIC:                         1.634e+04
Df Model:                           3                                         
Covariance Type:                  HC0                                         
=====================================================================================
                        coef    std err          z      P&gt;|z|      [0.025      0.975]
-------------------------------------------------------------------------------------
const                 0.9799      0.040     24.675      0.000       0.902       1.058
education             0.1114      0.002     50.185      0.000       0.107       0.116
experience            0.0229      0.002     12.257      0.000       0.019       0.027
experience_sq_div    -0.0347      0.004     -8.965      0.000      -0.042      -0.027
==============================================================================
Omnibus:                     4380.404   Durbin-Watson:                   1.833
Prob(Omnibus):                  0.000   Jarque-Bera (JB):           134722.859
Skew:                          -1.401   Prob(JB):                         0.00
Kurtosis:                      20.406   Cond. No.                         219.
==============================================================================

Notes:
[1] Standard Errors are heteroscedasticity robust (HC0)</code></pre>
</div>
</div>
</section>

<section id="properties" class="title-slide slide level3 center" data-background="#43464B" data-visibility="uncounted">
<h3>Properties</h3>

</section>
<section id="t-test-under-h_0-size" class="slide level4">
<h4><span class="math inline">\(t\)</span>-Test under <span class="math inline">\(H_0\)</span>: Size</h4>
<p>What is the (asymptotic) probability of rejecting under <span class="math inline">\(H_0\)</span>?</p>
<div class="fragment">
<p><span class="math display">\[
\begin{aligned}
&amp; P\left(\text{Reject} H_0|H_0 \right) = P\left(\abs{t}&gt;z_{1-\alpha/2} |H_0\right) \\
&amp; = P\left( \abs{ \dfrac{\hat{\beta}_2}{\sqrt{ \widehat{\avar}(\hat{\beta}_2)/N }  }}&gt; z_{1-\alpha/2}\Bigg|H_0 \right)\\
&amp; \to \Phi(z_{\alpha/2}) + (1- \Phi(z_{1-\alpha/2})) = \alpha
\end{aligned}
\]</span></p>
</div>
<div class="fragment">
<p>The test has asymptotic size <span class="math inline">\(\alpha\)</span></p>
</div>
</section>
<section id="t-test-under-h_1-consistency" class="slide level4">
<h4><span class="math inline">\(t\)</span>-Test under <span class="math inline">\(H_1\)</span>: Consistency</h4>
<p>What happens to <span class="math inline">\(t\)</span> under <span class="math inline">\(H_1\)</span>? Suppose that <span class="math inline">\(\beta_2\neq 0\)</span> is the true value. Can write <span class="math display">\[ \small
t = \dfrac{\hat{\beta}_2}{\sqrt{ \widehat{\avar}(\hat{\beta}_2)/N }  }=  \underbrace{\dfrac{\hat{\beta}_2 - \beta_2}{\sqrt{ \widehat{\avar}(\hat{\beta}_2)/N }  }}_{\scriptsize \xrightarrow{d} N(0, 1)} +  \underbrace{\dfrac{\beta_2}{\sqrt{ \widehat{\avar}(\hat{\beta}_2)/N }  }}_{\scriptsize \xrightarrow{p} \pm \infty }
\]</span></p>
<div class="fragment">
<p>It follows (why?) that the <span class="math inline">\(t\)</span>-test is consistent <span class="math display">\[ \small
P(\text{Reject } H_0|H_1) \xrightarrow{N\to\infty} 1
\]</span></p>
</div>
</section>
<section id="t-test-for-h_0beta_2-c" class="slide level4">
<h4><span class="math inline">\(t\)</span>-Test for <span class="math inline">\(H_0:\beta_2 = c\)</span></h4>
<p>More generally, can test <span class="math display">\[
H_0: \beta_k = c \text{ vs } H_1: \beta_k \neq c
\]</span></p>
<div class="fragment">
<p><span class="math inline">\(t\)</span>-statistic <span id="eq-vector-inference-t-general"><span class="math display">\[
t = \dfrac{\hat{\beta}_k - c}{\sqrt{ \widehat{\avar}(\hat{\beta}_k)/N }  }
\tag{2}\]</span></span></p>
<p>Same decision rule: compare <span class="math inline">\(t\)</span> to <span class="math inline">\(z_{1-\alpha/2}\)</span></p>
</div>
</section>
<section id="intuition-what-the-test-does" class="slide level4">
<h4>Intuition: What the Test Does</h4>
<ul>
<li class="fragment">Under <span class="math inline">\(H_0\)</span>, the <span class="math inline">\(t\)</span> statistic should be “well-behaved”: normal and centered at 0. Big values of <span class="math inline">\(t\)</span>-statistic unlikely</li>
<li class="fragment">So if we see a big <span class="math inline">\(t\)</span>-statistic, such a value is unlikely under <span class="math inline">\(H_0\)</span> — evidence against <span class="math inline">\(H_0\)</span></li>
<li class="fragment">If value is large enough, we think the evidence is strong enough to be reasonably incompatible with <span class="math inline">\(H_0\)</span> — rejection</li>
</ul>
</section>
<section id="combined-result-t-statistics" class="slide level4">
<h4>Combined Result: <span class="math inline">\(t\)</span>-statistics</h4>
<div class="rounded-box">
<div id="prp-vector-inference-t" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 1</strong></span> Let the assumptions for asymptotic normality of the OLS estimator hold. Let <span class="math inline">\(t\)</span> be defined as in <a href="#/eq-vector-inference-t-general" class="quarto-xref">Equation&nbsp;2</a>. Then</p>
<ol type="1">
<li class="fragment">If <span class="math inline">\(H_0: \beta_k=c\)</span> holds, then <span class="math inline">\(t\xrightarrow{d} N(0, 1)\)</span> The associated test has asymptotic size <span class="math inline">\(\alpha\)</span></li>
<li class="fragment">If <span class="math inline">\(H_0: \beta_k=c\)</span> does not hold, then <span class="math inline">\(t\xrightarrow{p}\pm\infty\)</span>. The associated test is consistent</li>
</ol>
</div>
</div>
</section>
<section id="estimating-avarhatbbeta" class="slide level4">
<h4>Estimating <span class="math inline">\(\avar(\hat{\bbeta})\)</span></h4>
<p>One remaining issue: how to estimate <span class="math display">\[
\avar(\hat{\bbeta}) =  \left( \E[\bX_i\bX_i']\right)^{-1} \E[U_i^2\bX_i\bX_i']\left( \E[\bX_i\bX_i']\right)^{-1}
\]</span></p>
<div class="fragment">
<p>Can estimate using <span class="highlight">sample analogs</span></p>
<ol type="1">
<li class="fragment"><span class="math inline">\(\left( \E[\bX_i\bX_i']\right)^{-1}\)</span> with <span class="math inline">\(\left( N^{-1}\sum_{i=1}^N  \bX_i\bX_i'\right)^{-1}\)</span></li>
<li class="fragment"><span class="math inline">\(\E[U_i^2\bX_i\bX_i']\)</span> with <span class="math inline">\(N^{-1}\sum_{i=1}^N \hat{U}_i \bX_i\bX_i'\)</span> for <span class="math inline">\(\hat{U}_i = Y_i-\bX_i'\hat{\bbeta}\)</span></li>
</ol>
</div>
</section>
<section id="estimating-avarhatbbeta-robust-standard-errors" class="slide level4">
<h4>Estimating <span class="math inline">\(\avar(\hat{\bbeta})\)</span>: Robust Standard Errors</h4>
<p>Resulting <span class="math inline">\(\widehat{\avar}(\hat{\bbeta})\)</span> is consistent: <span class="math display">\[
\widehat{\avar}(\hat{\bbeta}) \xrightarrow{p} {\avar}(\hat{\bbeta})
\]</span></p>
<ul>
<li class="fragment">Can use in test statistics</li>
<li class="fragment"><span class="math inline">\(N^{-1}\widehat{\avar}(\hat{\bbeta})\)</span> is called <em>robust</em> (or <em>heteroskedasticity robust</em>) standard errors — specifically, <span class="highlight">HC0</span></li>
<li class="fragment">In <code>statsmodels</code>, we used them by called <code>OLS(endog, exog).fit(cov_type='HC0')</code></li>
</ul>
</section>
</section>
<section>
<section id="general-linear-hypotheses" class="title-slide slide level2 center" data-background="#00100F">
<h2>General Linear Hypotheses</h2>

</section>
<section id="example-and-wald-statistic" class="title-slide slide level3 center" data-background="#43464B" data-visibility="uncounted">
<h3>Example and Wald Statistic</h3>

</section>
<section id="motivation-need-tests-for-multiple-restrictions" class="slide level4">
<h4>Motivation: Need Tests for Multiple Restrictions</h4>
<ul>
<li class="fragment"><span class="math inline">\(t\)</span>-tests allowed us to test if education mattered (<span class="math inline">\(\beta_2=0\)</span>)</li>
<li class="fragment">But next question is whether experience affects wages: <span class="math display">\[
H_0: \begin{cases}
\beta_3 =0\\
\beta_4 = 0
\end{cases} \quad
\text{ vs }  \quad H_1: \beta_3 \neq 0\text{ or } \beta_4 \neq 0
\]</span></li>
<li class="fragment"><span class="math inline">\(H_0\)</span> has two constraints at the same time!</li>
</ul>
<div class="fragment">
<div class="callout callout-note no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p>The “or” in <span class="math inline">\(H_1\)</span> allows the possibility that <span class="highlight">both</span> <span class="math inline">\(\beta_3\neq 0\)</span> and <span class="math inline">\(\beta_4\neq 0\)</span></p>
</div>
</div>
</div>
</div>
</section>
<section id="matrix-representation-of-the-null" class="slide level4">
<h4>Matrix Representation of the Null</h4>
<p>Can write our <span class="math inline">\(H_0\)</span> as <span class="math display">\[
\bR\bbeta = \bq
\]</span> for <span class="math display">\[
\bR = \begin{pmatrix}
0 &amp; 0 &amp; 1 &amp; 0\\
0 &amp; 0 &amp; 0 &amp; 1
\end{pmatrix}, \quad \bq =\begin{pmatrix}
0 \\
0
\end{pmatrix}
\]</span></p>
</section>
<section id="linear-hypotheses" class="slide level4">
<h4>Linear Hypotheses</h4>
<p>More generally, can consider <span class="highlight">linear hypotheses</span> of the form <span class="math display">\[
\bR\bbeta = \bq
\]</span></p>
<p>Here</p>
<ul>
<li class="fragment"><span class="math inline">\(\bbeta\)</span> is <span class="math inline">\(p\times 1\)</span></li>
<li class="fragment"><span class="math inline">\(\bR\)</span> is <span class="math inline">\(k\times p\)</span> with maximum rank — <span class="math inline">\(k\)</span> constraints</li>
<li class="fragment"><span class="math inline">\(k\geq 1\)</span> and <span class="math inline">\(k\leq p\)</span></li>
</ul>
<div class="fragment">
<div class="callout callout-note no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p>Covers both example <span class="math inline">\(H_0\)</span> we have seen so far</p>
</div>
</div>
</div>
</div>
</section>
<section id="towards-a-statistic" class="slide level4">
<h4>Towards a Statistic</h4>
<p>Intuitive way to construct a statistic</p>
<div class="rounded-box">
<p>Check the distance between <span class="math inline">\(\bR\hat{\bbeta}\)</span> and <span class="math inline">\(\bq\)</span></p>
</div>
<div class="fragment">
<ul>
<li class="fragment">Reject if distance is large, do not reject if not</li>
<li class="fragment">How to pick “large” to ensure correct test size?</li>
<li class="fragment"><span class="math inline">\(\Rightarrow\)</span> need to combine asymptotic distribution of <span class="math inline">\(\bR\hat{\bbeta}\)</span> and distance</li>
</ul>
</div>
</section>
<section id="asymptotic-distribution-of-brhatbbeta" class="slide level4">
<h4>Asymptotic Distribution of <span class="math inline">\(\bR\hat{\bbeta}\)</span></h4>
<p>Recall that <span class="math display">\[
\sqrt{N}(\hat{\bbeta}-\bbeta)\xrightarrow{d} N(0, \avar(\bbeta))
\]</span></p>
<div class="fragment">
<p>By the CMT <span class="math display">\[
\sqrt{N}(\bR\hat{\bbeta}-\bR\bbeta) \xrightarrow{d} N(0, \bR\avar(\bbeta)\bR')
\]</span></p>
</div>
</section>
<section id="chi2-random-variables" class="slide level4">
<h4><span class="math inline">\(\chi^2\)</span> Random Variables</h4>
<p>A special useful distribution</p>
<div class="rounded-box">
<div id="eq-vector-inference-chi2">
<p>Let <span class="math inline">\(Z_1, \dots, Z_k\)</span> be independent <span class="math inline">\(N(0, 1)\)</span> variables. The distribution of <span class="math inline">\(\sum_{j=1}^k Z_j^2\)</span> is called the chi-squared distribution with <span class="math inline">\(k\)</span> degrees of freedom (written <span class="math inline">\(\chi^2_k\)</span>)</p>
</div>
</div>
<div class="fragment">
<ul>
<li class="fragment">If <span class="math inline">\(\bZ=(Z_1, \dots, Z_k)\)</span>, then <span class="math inline">\(\bZ\sim N(0, \bI_k)\)</span> and <span class="math inline">\(\norm{\bZ}^2 = \bZ'\bZ \sim \chi^2_k\)</span></li>
<li class="fragment">Has two ingredients we need: normality and distance</li>
</ul>
</div>
</section>
<section id="wald-statistic" class="slide level4">
<h4>Wald Statistic</h4>
<p><br></p>
<p>The following statistic is called a <span class="highlight">Wald</span> statistic: <span id="eq-vector-inference-wald"><span class="math display">\[
W = N\left(  \bR\hat{\bbeta}-\bq   \right)'\left(\bR\widehat{\avar}(\bbeta)\bR'\right)^{-1}\left(  \bR\hat{\bbeta}-\bq   \right)
\tag{3}\]</span></span></p>
<ul>
<li class="fragment">Interpretation: weighted distance</li>
<li class="fragment">Weighted by the inverse of the variance-covariance matrix</li>
</ul>
</section>
<section id="decision-rule-wald-test" class="slide level4">
<h4>Decision Rule: Wald Test</h4>
<p>We call the following the <span class="highlight">asymptotic size <span class="math inline">\(\alpha\)</span> Wald-test</span>:</p>
<p><br></p>
<div class="rounded-box">
<p>Let <span class="math inline">\(c_{1-\alpha}\)</span> solve <span class="math inline">\(P(\chi^2_k\leq c_{1-\alpha})=1-\alpha\)</span> where <span class="math inline">\(k\)</span> is the number of rows and rank of <span class="math inline">\(\bR\)</span>. Then</p>
<ul>
<li class="fragment">Reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(W&gt;c_{1-\alpha}\)</span></li>
<li class="fragment">Do not reject <span class="math inline">\(H_0\)</span> if <span class="math inline">\(W\leq c_{1-\alpha}\)</span></li>
</ul>
</div>
</section>
<section id="plot-pdf-of-chi2_k-and-rejection-region-shaded" class="slide level4">
<h4>Plot: PDF of <span class="math inline">\(\chi^2_k\)</span> and Rejection Region (Shaded)</h4>
<div id="8b842cb1" class="cell" data-execution_count="8">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="ols-inference_files/figure-revealjs/cell-9-output-1.png" width="1163" height="467"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="wald-and-t-statistics" class="slide level4">
<h4>Wald and <span class="math inline">\(t\)</span> Statistics</h4>
<p>What if <span class="math inline">\(k=1\)</span>: only one constraint?</p>
<div class="fragment">
<p><br></p>
<ul>
<li class="fragment">Wald statistic is the square of the corresponding <span class="math inline">\(t\)</span>-statistic (show this)</li>
<li class="fragment">You lose and win nothing by doing a Wald test even if you have a single hypothesis</li>
</ul>
</div>
</section>

<section id="illustration-1" class="title-slide slide level3 center" data-background="#43464B" data-visibility="uncounted">
<h3>Illustration</h3>

</section>
<section id="effect-of-experience-expressing-br-and-bq" class="slide level4">
<h4>Effect of Experience: Expressing <span class="math inline">\(\bR\)</span> and <span class="math inline">\(\bq\)</span></h4>
<p>The results class in <code>statsmodels</code> has a <code>wald_test()</code> method</p>
<div class="fragment">
<p>First need to define the <span class="math inline">\(\bR\)</span> and <span class="math inline">\(\bq\)</span> matrices:</p>
<div id="fdfc0aa3" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a></a>constraint_matrix <span class="op">=</span> np.array( </span>
<span id="cb12-2"><a></a>    [[<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>],</span>
<span id="cb12-3"><a></a>     [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>]]</span>
<span id="cb12-4"><a></a>)</span>
<span id="cb12-5"><a></a></span>
<span id="cb12-6"><a></a>rhs_vector <span class="op">=</span> np.array(</span>
<span id="cb12-7"><a></a>    [<span class="dv">0</span>, <span class="dv">0</span>]</span>
<span id="cb12-8"><a></a>)</span>
<span id="cb12-9"><a></a></span>
<span id="cb12-10"><a></a><span class="bu">print</span>(constraint_matrix, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>, rhs_vector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0 0 1 0]
 [0 0 0 1]] 
 [0 0]</code></pre>
</div>
</div>
</div>
</section>
<section id="effect-of-experience-using-wald_test" class="slide level4">
<h4>Effect of Experience: Using <code>wald_test()</code></h4>
<p>Then can supply <span class="math inline">\(\bR\)</span> and <span class="math inline">\(\bq\)</span> to <code>wald_test()</code> as a tuple:</p>
<div id="de663683" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a></a>wald_results <span class="op">=</span> results.wald_test(</span>
<span id="cb14-2"><a></a>  (constraint_matrix, rhs_vector), </span>
<span id="cb14-3"><a></a>  use_f<span class="op">=</span><span class="va">False</span>, </span>
<span id="cb14-4"><a></a>  scalar<span class="op">=</span><span class="va">True</span></span>
<span id="cb14-5"><a></a>)</span>
<span id="cb14-6"><a></a><span class="bu">print</span>(wald_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Wald test (chi2): statistic=270.09702395844937, p-value=2.2344799298840845e-59, df_denom=2&gt;</code></pre>
</div>
</div>
<div class="fragment">
<p><br></p>
<ul>
<li class="fragment">Strong evidence against <span class="math inline">\(H_0: \beta_3=\beta_4=0\)</span></li>
<li class="fragment">Experience matters for earnings</li>
</ul>
</div>
</section>
<section id="second-example-effect-of-experience-for-10-years" class="slide level4">
<h4>Second Example: Effect of Experience for 10 Years</h4>
<p>Recall other parameter of interest: <span class="math inline">\(100\beta_3 + 20\beta_4\)</span>. Can ask: <span class="math display">\[ \small
H_0: 100\beta_3 + 20\beta_4 = 1.4\quad  \text{ vs } \quad  H_0: 100\beta_3 + 20\beta_4 \neq 1.4
\]</span></p>
<div class="fragment">
<p>Can also do Wald test:</p>
<div id="e6acfe76" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a></a>constraint_matrix <span class="op">=</span> np.array( </span>
<span id="cb16-2"><a></a>    [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">100</span>, <span class="dv">20</span>], </span>
<span id="cb16-3"><a></a>)</span>
<span id="cb16-4"><a></a>rhs_vector <span class="op">=</span> np.array(</span>
<span id="cb16-5"><a></a>    [<span class="fl">1.4</span>]</span>
<span id="cb16-6"><a></a>)</span>
<span id="cb16-7"><a></a><span class="co"># Perform test</span></span>
<span id="cb16-8"><a></a>wald_results <span class="op">=</span> results.wald_test((constraint_matrix, rhs_vector), use_f<span class="op">=</span><span class="va">False</span>, scalar<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb16-9"><a></a><span class="bu">print</span>(wald_results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Wald test (chi2): statistic=2.815200772707648, p-value=0.09337521301524496, df_denom=1&gt;</code></pre>
</div>
</div>
<div class="footer">

</div>
</div>
</section>

<section id="properties-1" class="title-slide slide level3 center" data-background="#43464B" data-visibility="uncounted">
<h3>Properties</h3>

</section>
<section id="why-normalize-by-bravarbbetabr-1" class="slide level4">
<h4>Why Normalize by <span class="math inline">\(( \bR\avar(\bbeta)\bR')^{-1}\)</span></h4>
<ul>
<li class="fragment">Under <span class="math inline">\(H_0: \bR\bbeta=\bq\)</span> it holds that <span class="math display">\[
\sqrt{N}(\bR\hat{\bbeta}-\bq) \xrightarrow{d} N(0, \bR\avar(\bbeta)\bR')
\]</span></li>
<li class="fragment"><span class="math inline">\(\norm{\bR\hat{\bbeta}-\bq}^2\)</span> is <span class="highlight"> not </span> <span class="math inline">\(\chi^2\)</span> unless <span class="math inline">\(\bR\avar(\bbeta)\bR'= \bI_k\)</span></li>
</ul>
<div class="fragment">
<p><br></p>
<p><span class="math inline">\(\Rightarrow\)</span> In general need to something transform <span class="math inline">\(\bR\hat{\bbeta}-\bq\)</span> to get <span class="math inline">\(\bI_k\)</span> asymptotic variance for <span class="math inline">\(\chi^2_k\)</span> limit</p>
</div>
</section>
<section id="matrix-square-root" class="slide level4">
<h4>Matrix Square Root</h4>
<ul>
<li class="fragment">Recall: if <span class="math inline">\(W\sim N(0, \sigma^2)\)</span>, then <span class="math inline">\(W/\sigma \sim N(0, 1)\)</span></li>
<li class="fragment">Similar result can be used for vectors <span class="math inline">\(\bW\sim N(0, \bSigma)\)</span></li>
</ul>
<div class="fragment">
Just need to define “<span class="math inline">\(\sqrt{\Sigma}\)</span>”
<div class="rounded-box">
<div id="prp-vector-inference-sqrt" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 2</strong></span> Let <span class="math inline">\(\bSigma\)</span> be a positive definite matrix. Then there is a unique positive definite matrix <span class="math inline">\(\bSigma^{1/2}\)</span> such that <span class="math display">\[
\bSigma^{1/2} \bSigma^{1/2} =  \bSigma
\]</span></p>
</div>
</div>
<div class="footer">
<p>See <a href="https://en.wikipedia.org/wiki/Definite_matrix#Square_root">Wikipedia</a> on matrix square roots</p>
</div>
</div>
</section>
<section id="standardizing-brhatbbeta" class="slide level4">
<h4>Standardizing <span class="math inline">\(\bR\hat{\bbeta}\)</span></h4>
<ul>
<li class="fragment">So if <span class="math inline">\(\bW\sim N(0, \bSigma)\)</span> with full rank <span class="math inline">\(\bSigma\)</span> <span class="math display">\[\small
(\bSigma^{1/2})^{-1}\bW \sim N(0, (\bSigma^{1/2})^{-1}\bSigma(\bSigma^{1/2})^{-1}) = N(0, \bI_k)
\]</span></li>
<li class="fragment">Or <span class="math display">\[ \small
((\bSigma^{1/2})^{-1}\bW )'(\bSigma^{1/2})^{-1}\bW ) = \bW' \bSigma^{-1}\bW\sim \chi^2_k
\]</span></li>
</ul>
<div class="fragment">
<p>We just take <span class="math inline">\(\bW=\sqrt{N}(\hat{\bbeta}-\bbeta)\)</span> and apply the argument asymptotically and with an estimator of <span class="math inline">\(\avar(\hat{\bbeta})\)</span></p>
<div class="footer">

</div>
</div>
</section>
<section id="wald-test-under-h_0-size" class="slide level4">
<h4>Wald Test under <span class="math inline">\(H_0\)</span>: Size</h4>
<p>Under the null <span class="math inline">\(H_0: \bR\bbeta=\bq\)</span></p>
<div class="fragment">
<p>By Slutsky’s theorem and the above it follows <span class="math display">\[
W = N\left(  \bR\hat{\bbeta}-\bq   \right)'\left(\bR\widehat{\avar}(\bbeta)\bR'\right)^{-1}\left(  \bR\hat{\bbeta}-\bq   \right) \xrightarrow{d} \chi^2_k
\]</span></p>
</div>
<div class="fragment">
<p><br></p>
<p>Hence the test is asymptotically size <span class="math inline">\(\alpha\)</span> <span class="math display">\[ \small
P(\text{Reject } H_0|H_0) \xrightarrow{N\to\infty} \alpha
\]</span></p>
</div>
</section>
<section id="wald-test-under-h_1-consistency" class="slide level4">
<h4>Wald Test under <span class="math inline">\(H_1\)</span>: Consistency</h4>
<p>Suppose that <span class="math inline">\(H_1\)</span> holds: <span class="math inline">\(\bR\bbeta\neq \bq\)</span>. Then</p>
<ul>
<li class="fragment"><span class="math inline">\(\bR\hat{\bbeta}-\bq\)</span> converges to something <span class="math inline">\(\neq 0\)</span></li>
<li class="fragment"><span class="math inline">\(\left(\bR\widehat{\avar}(\bbeta)\bR'\right)^{-1}\xrightarrow{p} \left(\bR{\avar}(\bbeta)\bR'\right)^{-1}\)</span> by the CMT</li>
<li class="fragment"><span class="math inline">\(\left(\bR{\avar}(\bbeta)\bR'\right)^{-1}\)</span> is positive definite (why?)</li>
</ul>
<div class="fragment">
<p>It follows (why?) that <span class="math inline">\(W\to+\infty\)</span> and<br>
<span class="math display">\[ \small
P(\text{Reject } H_0|H_1) \xrightarrow{N\to\infty} 1
\]</span></p>
</div>
</section>
<section id="combined-result-wald-statistic-and-test" class="slide level4">
<h4>Combined Result: Wald Statistic and Test</h4>
<div class="rounded-box">
<div id="prp-vector-inference-wald" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 3</strong></span> Let the assumptions for asymptotic normality of the OLS estimator hold. Let <span class="math inline">\(W\)</span> be defined as in <a href="#/eq-vector-inference-wald" class="quarto-xref">Equation&nbsp;3</a> and let <span class="math inline">\(\bR\)</span> have rank <span class="math inline">\(k\)</span>. Then</p>
<ol type="1">
<li class="fragment">If <span class="math inline">\(H_0: \bR\bbeta=\bq\)</span> holds, then <span class="math inline">\(W\xrightarrow{d} \chi^2_k\)</span>. The associated test has asymptotic size <span class="math inline">\(\alpha\)</span></li>
<li class="fragment">If <span class="math inline">\(H_0: \bR\bbeta=\bq\)</span> does not hold, then <span class="math inline">\(W\xrightarrow{p} +\infty\)</span>. The associated test is consistent</li>
</ol>
</div>
</div>
</section>
</section>
<section>
<section id="confidence-intervals-and-sets" class="title-slide slide level2 center" data-background="#00100F">
<h2>Confidence Intervals and Sets</h2>

</section>
<section id="point-vs.-interval-estimators" class="slide level4">
<h4>Point vs.&nbsp;Interval Estimators</h4>
<ul>
<li class="fragment">Our <span class="math inline">\(\hat{\bbeta}\)</span> is a <span class="highlight">point</span> estimator for <span class="math inline">\(\bbeta\)</span> — returns a single value in <span class="math inline">\(\R^p\)</span> for each sample</li>
<li class="fragment">Can also consider <span class="highlight">set estimator</span> — returns a whole set of values in <span class="math inline">\(\R^q\)</span> as a collection of guesses for <span class="math inline">\(\bbeta\)</span></li>
</ul>
<p><br></p>
<div class="fragment">
<ul>
<li class="fragment">Anything can be a set estimator, but we want “sensible” ones</li>
<li class="fragment">Leading example: confidence intervals/sets</li>
</ul>
</div>
</section>
<section id="confidence-sets-definition" class="slide level4">
<h4>Confidence Sets: Definition</h4>
<div class="rounded-box">
<div id="def-vector-inference-conf-set" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 6</strong></span> &nbsp;</p>
<ol type="1">
<li class="fragment"><p>A <span class="highlight"> <span class="math inline">\((1-\alpha)\times 100\%\)</span> confidence set for <span class="math inline">\(\theta\)</span> </span> (<span class="math inline">\(\theta\in\R^p\)</span>) is a random set <span class="math inline">\(S(X_1, \dots, X_N)\subseteq \R^p\)</span><br>
<span class="math display">\[ \scriptsize
P(\theta \in S(X_1, \dots, X_N)) = 1-\alpha
\]</span></p></li>
<li class="fragment"><p><span class="math inline">\(S(\cdot, \cdots)\)</span> is an <span class="highlight">asymptotic <span class="math inline">\((1-\alpha)\times 100\%\)</span> confidence set for <span class="math inline">\(\theta\)</span> </span> if <span class="math inline">\(\lim_{N\to\infty} P(\theta \in S(X_1, \dots, X_N)) = 1-\alpha\)</span></p></li>
<li class="fragment"><p><span class="math inline">\(P(\theta \in S(X_1, \dots, X_N))\)</span> is the <span class="highlight">coverage</span> of <span class="math inline">\(S\)</span></p></li>
</ol>
</div>
</div>
<div class="footer">

</div>
</section>
<section id="example-confidence-intervals-for-beta_k" class="slide level4">
<h4>Example: Confidence Intervals for <span class="math inline">\(\beta_k\)</span></h4>
<ul>
<li class="fragment">Can construct confidence sets based on asymptotic distribution of <span class="math inline">\(\hat{\bbeta}\)</span></li>
<li class="fragment">Example: try to construct a symmetric interval based on <span class="math inline">\(\hat{\beta}_k\)</span> (since limit distribution is symmetric around <span class="math inline">\(\beta_k\)</span>)</li>
</ul>
<div class="fragment">
<p>Such an interval takes form <span class="math display">\[
[\hat{\beta}_k - \hat{c}_N, \hat{\beta}_k + \hat{c}_N]
\]</span> Here <span class="math inline">\(\hat{c}_N\geq 0\)</span> can depend on the sample and <span class="math inline">\(N\)</span></p>
</div>
</section>
<section id="picking-hatc" class="slide level4">
<h4>Picking <span class="math inline">\(\hat{c}\)</span></h4>
<p><span class="math display">\[\scriptsize
\begin{aligned}
&amp; P\left(\beta_k\in[\hat{\beta}_k - \hat{c}_N, \hat{\beta}_k + \hat{c}]   \right)\\
&amp;   = P\left( - \frac{\hat{c}_N}{\sqrt{\widehat{\avar}(\hat{\beta}_k)/N} }\leq \sqrt{N} \frac{\hat{\beta}_k - \beta_k}{\widehat{\avar}(\hat{\beta}_k) }\leq   \frac{\hat{c}_N}{\sqrt{\widehat{\avar}(\hat{\beta}_k)/N}}  \right)\\
&amp; \approx \Phi\left(       \frac{\hat{c}_N}{\sqrt{\widehat{\avar}(\hat{\beta}_k)/N}}\right) - \Phi\left(  -\dfrac{\hat{c}_N}{\sqrt{\widehat{\avar}(\hat{\beta}_k)/N}} \right)
\end{aligned}
\]</span></p>
<div class="fragment">
<p>If we want <span class="math inline">\((1-\alpha)\times 100\%\)</span> asymptotic coverage, pick <span class="math inline">\(\hat{c}_N = z_{1-\alpha/2} \sqrt{ \frac{\widehat{\avar}(\hat{\beta}_k)}{N} }\)</span></p>
</div>
</section>
<section id="result-and-interpretation" class="slide level4">
<h4>Result and Interpretation</h4>
<div class="rounded-box">
<div id="prp-vector-inference-ci" class="theorem proposition">
<p><span class="theorem-title"><strong>Proposition 4</strong></span> The confidence interval <span id="eq-vector-inference-basic-ci"><span class="math display">\[ \small \hspace{-1.6cm}
S = \left[  \hat{\beta}_k -  z_{1-\alpha/2} \sqrt{ \frac{\widehat{\avar}(\hat{\beta}_k)}{N} }, \hat{\beta}_k+  z_{1-\alpha/2} \sqrt{ \frac{\widehat{\avar}(\hat{\beta}_k)}{N} }  \right]
\tag{4}\]</span></span> has asymptotic coverage <span class="math inline">\((1-\alpha)\times 100\%\)</span></p>
</div>
</div>
<div class="fragment">
<p>What is the interpretation of this interval?</p>
</div>
</section>
<section id="connection-to-t-tests-test-inversion" class="slide level4">
<h4>Connection to <span class="math inline">\(t\)</span>-Tests: Test Inversion</h4>
<p>There is an equivalent way to construct the confidence interval (<a href="#/eq-vector-inference-basic-ci" class="quarto-xref">4</a>)</p>
<ul>
<li class="fragment">Recall <span class="math inline">\(t\)</span>-statistic (<a href="#/eq-vector-inference-t-general" class="quarto-xref">2</a>) for <span class="math inline">\(H_0: \beta_k = c\)</span></li>
<li class="fragment"><span class="math inline">\(S\)</span> is the set of all <span class="math inline">\(c\)</span> for which the test does not reject</li>
</ul>
<div class="fragment">
<p><br></p>
<p>An example of <span class="highlight">test inversion</span> and equivalence between testing and confidence intervals</p>
</div>
</section>
<section id="multivariate-confidence-sets" class="slide level4">
<h4>Multivariate Confidence Sets</h4>
<ul>
<li class="fragment">Can also construct <span class="highlight">joint</span> confidence sets for multiple parts of <span class="math inline">\(\bbeta\)</span></li>
<li class="fragment">Example approach: inverting the Wald test for <span class="math inline">\(H_0: \bbeta = \bc\)</span></li>
<li class="fragment">A bit more advanced — can read in 7.18 in <span class="citation" data-cites="Hansen2022Econometrics">Hansen (<a href="#/references-1" role="doc-biblioref" onclick="">2022</a>)</span></li>
</ul>
<div class="fragment">
<p><br></p>
<p>There are other ways of constructing confidence sets</p>
</div>
</section></section>
<section>
<section id="recap-and-conclusions" class="title-slide slide level2 center" data-background="#00100F">
<h2>Recap and Conclusions</h2>

</section>
<section id="recap" class="slide level4">
<h4>Recap</h4>
<p>In this lecture we</p>
<ol type="1">
<li class="fragment">Reviewed key concepts from hypothesis testing</li>
<li class="fragment">Discussed <span class="math inline">\(t\)</span>- and Wald tests for linear hypotheses</li>
<li class="fragment">Constructed an asymptotic confidence interval for a coefficient value</li>
</ol>
</section>
<section id="next-questions" class="slide level4">
<h4>Next Questions</h4>
<p><br></p>
<ul>
<li class="fragment">What if the hypothesis is not linear in coefficients?</li>
<li class="fragment">How do nonlinear transformations of parameters behave?</li>
</ul>
</section>
<section id="references-1" class="slide level4 allowframebreaks smaller scrollable" data-visibility="uncounted">
<h4>References</h4>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Hansen2022Econometrics" class="csl-entry" role="listitem">
Hansen, Bruce. 2022. <em>Econometrics</em>. Princeton_University_Press.
</div>
<div id="ref-Wooldridge2020IntroductoryEconometricsModern" class="csl-entry" role="listitem">
Wooldridge, Jeffrey M. 2020. <em>Introductory <span>Econometrics</span>: A <span>Modern Approach</span></em>. Seventh edition. Boston, MA: Cengage.
</div>
<div id="ref-Wooldridge2023WhatStandardError" class="csl-entry" role="listitem">
———. 2023. <span>“What Is a <span>Standard Error</span>? (And <span>How Should We Compute It</span>?).”</span> <em>Journal of Econometrics</em> 237 (2): 105517. <a href="https://doi.org/10.1016/j.jeconom.2023.105517">https://doi.org/10.1016/j.jeconom.2023.105517</a>.
</div>
</div>


<div class="reveal-header">
<div class="header-logo" data-footer-logo-link="https://vladislav-morozov.github.io/econometrics-2/">
<img data-src="">
</div>
<div class="sc-title">
<p> </p>
</div>
<div class="header-text">
<p> </p>
</div>
<div class="sb-title">
<p> </p>
</div>
</div>
</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../../themes/favicon.ico" class="slide-logo"></p>
<div class="footer footer-default">
<p>A Deeper Look at Linear Regression: Testing Linear Hypotheses. CIs</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'convex',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'fast',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1150,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/vladislav-morozov\.github\.io\/econometrics-2\/");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>